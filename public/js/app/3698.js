(self.webpackChunk=self.webpackChunk||[]).push([[3698],{73698:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>h});var a=n(9669),r=n.n(a),o=n(34354),s=n(87757),i=n.n(s);function c(t,e,n,a,r,o,s){try{var i=t[o](s),c=i.value}catch(t){return void n(t)}i.done?e(c):Promise.resolve(c).then(a,r)}const l={random:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8,e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";e||(n="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789");for(var a="",r=0;r<t;r++)a+=n.charAt(Math.floor(Math.random()*n.length));return a},downloadImage:function(){var t,e=(t=i().mark((function t(e){var n,a;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.url,a=e.label,t.next=3,r().get(n,{responseType:"blob"}).then((function(t){var e=new Blob([t.data],{type:"image/png"}),n=document.createElement("a");n.href=URL.createObjectURL(e),n.download=a,n.click(),URL.revokeObjectURL(n.href)})).catch(console.error);case 3:case"end":return t.stop()}}),t)})),function(){var e=this,n=arguments;return new Promise((function(a,r){var o=t.apply(e,n);function s(t){c(o,a,r,s,i,"next",t)}function i(t){c(o,a,r,s,i,"throw",t)}s(void 0)}))});return function(t){return e.apply(this,arguments)}}()};var d=n(72788),u=n(43671);const v={name:"Presensi",data:function(){return{collapseAdd:!1,title:"",code:"",initials:{title:"",code:""},isUploading:!1,hasError:!1,list:[]}},methods:{saveAttendance:function(t){t.preventDefault(),this.hasError=!1,this.isUploading=!0;var e=this;if(this.title&&this.code){var n={title:this.title,code:this.code};u.Z.setHeader("Content-Type","application/json"),u.Z.post(o.Z.attendanceAdd,n).then((function(t){if(t.data.error)e.hasError=!0;else{var n=t.data.id;e.list.push({id:n,No:e.list.length+1,Title:e.title,"Kode Presensi":e.code,Status:!1}),e.resetValues()}})).catch((function(t){e.hasError=!0}))}},getDataset:function(){return this.list},generateCode:function(){this.code=l.random(8,!1)},changeStatus:function(t){var e=this;u.Z.setHeader("Content-Type","application/json"),u.Z.post(o.Z.attendancesStatus,{id:t}).then((function(n){if(n.data.error)console.log("Validation Error");else{var a=e.list.find((function(e){return e.id===t}));a&&(a.Status=!a.Status)}}))},resetValues:function(){this.isUploading=!1,this.hasError=!1,this.title=this.initials.title,this.code=this.initials.code},openDetails:function(t){console.log(t)},downloadQR:function(t,e){var n=encodeURIComponent(window.location.origin+d.Z.attendQR+t);l.downloadImage({url:"https://api.qrserver.com/v1/create-qr-code/?"+"data=".concat(n,"&size=450x450&margin=0&download=true"),label:e+"_"+t})},retrieve:function(){var t=this;u.Z.get(o.Z.attendances).then((function(e){t.list=e.data.map((function(t,e){return{id:t.id,No:e+1,Title:t.title,"Kode Presensi":t.code,Status:t.status}}))}))}},mounted:function(){this.retrieve()}};const h=(0,n(51900).Z)(v,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("CCol",{attrs:{sm:"12"}},[n("CButton",{staticClass:"mb-3",attrs:{color:"primary"},on:{click:function(e){t.collapseAdd=!t.collapseAdd}}},[t._v("\n            Tambah Presensi\n        ")]),t._v(" "),n("CCollapse",{attrs:{show:t.collapseAdd,duration:400}},[n("CCard",{attrs:{"border-color":t.isUploading?"warning":t.hasError?"danger":""}},[n("CCardHeader",{attrs:{"body-wrapper":""}},[n("CCardText",[t._v("Form Pertanyaan")])],1),t._v(" "),n("CCardBody",[n("CForm",{on:{submit:t.saveAttendance}},[n("CRow",[n("CCol",{attrs:{sm:"3"}},[t._v("\n                                Nama (sebagai pembeda)\n                            ")]),t._v(" "),n("CCol",{attrs:{sm:"9"}},[n("CInput",{model:{value:t.title,callback:function(e){t.title=e},expression:"title"}})],1)],1),t._v(" "),n("CRow",[n("CCol",{attrs:{sm:"3"}},[t._v("\n                                Kode Presensi\n                            ")]),t._v(" "),n("CCol",{attrs:{sm:"6"}},[n("CInput",{model:{value:t.code,callback:function(e){t.code=e},expression:"code"}})],1),t._v(" "),n("CCol",{attrs:{sm:"3"}},[n("CButton",{attrs:{color:"primary"},on:{click:function(e){return t.generateCode()}}},[t._v("\n                                    Generate\n                                ")])],1)],1),t._v(" "),n("CRow",[n("CButton",{staticClass:"mx-3",attrs:{type:"submit",size:"sm",color:"warning"}},[t._v("\n                                Tambahkan\n                            ")]),t._v(" "),n("CButton",{attrs:{color:"danger"},on:{click:t.resetValues}},[t._v("\n                                Reset\n                            ")])],1)],1)],1)],1)],1)],1),t._v(" "),n("CCol",{attrs:{sm:"12",md:"12"}},[n("CCard",[n("CCardHeader",[t._v("\n                Presensi Tersedia\n            ")]),t._v(" "),n("CCardBody",[n("CDataTable",{attrs:{wrap:"",hover:"",fixed:"",fields:["No","Title","Kode Presensi","Status","Aksi"],items:t.list,"items-per-page":10,pagination:""},scopedSlots:t._u([{key:"Status",fn:function(e){var a=e.item;return[n("td",[n("CBadge",{attrs:{color:a.Status?"success":"danger"}},[t._v("\n                                "+t._s(a.Status?"Buka":"Tutup")+"\n                            ")])],1)]}},{key:"Aksi",fn:function(e){var a=e.item;return[n("td",[n("CButton",{attrs:{color:a.Status?"danger":"success",size:"sm"},on:{click:function(e){return t.changeStatus(a.id)}}},[t._v("\n                                "+t._s(a.Status?"Tutup":"Buka")+"\n                            ")]),t._v(" "),n("CButton",{attrs:{color:"primary",size:"sm"},on:{click:function(e){return t.downloadQR(a["Kode Presensi"],a.Title)}}},[t._v("\n                                Download QR\n                            ")]),t._v(" "),n("router-link",{attrs:{to:"/presensi/"+a.id}},[n("CButton",{attrs:{color:"warning",size:"sm"}},[t._v("\n                                    Detail\n                                ")])],1)],1)]}}])})],1)],1)],1)],1)}),[],!1,null,"378e3627",null).exports}}]);